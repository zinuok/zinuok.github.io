{{/* =========================
   Authors (keep it simple)
   ========================= */}}

{{ $authors := .Params.authors }}

{{ if $authors }}
<div class="authors">
  {{ range $i, $a := $authors }}
    <span class="author">{{ $a | markdownify }}</span>{{ if lt $i (sub (len $authors) 1) }}, {{ end }}
  {{ end }}
</div>
{{ end }}

{{/* =========================
   Equal contribution legend (create)
   ========================= */}}

{{ $has_equal := false }}
{{ with .Params.author_notes }}
  {{ range . }}
    {{ if eq . "Equal contribution" }}{{ $has_equal = true }}{{ end }}
  {{ end }}
{{ end }}

{{ if $has_equal }}
<div id="equal-contrib-legend" style="font-size:0.85em; margin-top:0.25em; line-height:1.3;">
  (* Equal contribution)
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const legend = document.getElementById('equal-contrib-legend');
  if (!legend) return;

  // publication(학회/저널) 라인 요소를 찾고, 그 다음 줄로 legend를 이동
  const pub =
    document.querySelector('.pub-publication') ||
    document.querySelector('[class*="pub-publication"]');

  if (pub && pub.parentNode) {
    pub.insertAdjacentElement('afterend', legend);
  } else {
    // publication을 못 찾으면 (레이아웃 차이) 그냥 현재 위치(저자 아래)에 남겨둠
  }
});
</script>
{{ end }}

<script>
document.addEventListener('DOMContentLoaded', function () {
  // (YYYY). 형태 제거 (citation 문장 맨 앞)
  const title = {{ .Params.title | jsonify }};
  const year = {{ .Date.Format "2006" | jsonify }};

  // title을 포함하는 문장(=citation)을 찾아서 맨 앞의 "(YYYY)."만 제거
  const nodes = document.querySelectorAll('main p, main div, main span, article p, article div, article span');

  nodes.forEach(el => {
    const t = (el.textContent || '').trim();

    // 예: "(2025). VR-Drive: ... "
    if (t.startsWith(`(${year}).`) && t.includes(title)) {
      el.textContent = t.replace(`(${year}).`, '').trimStart();
    }
  });
});
</script>
